@Library('jenkins-pipeline-library') _

pipeline {
    agent any
	

    stages {

    
        stage('checkout') {
            steps {
               git url : 'https://github.com/GJohannes/baJenkins'
            }
        }
        stage('Configure artifactory') {
        	def server = Artifactory.server 'artifactory'
    		def rtMaven = Artifactory.newMavenBuild()
    		def buildInfo = Artifactory.newBuildInfo()
        
            rtMaven.tool = 'maven3'
            rtMaven.resolver releaseRepo: 'libs-release', snapshotRepo: 'libs-snapshot', server: server
            rtMaven.deployer releaseRepo: 'libs-release-local', snapshotRepo: 'libs-snapshot-local', server: server
            buildInfo.env.capture = true
        }
        stage('Build') {
           	
           	
           	agent {
				label "maven-3.5-jdk-8"
             }
             steps {
             	sh "mvn -version"
             	withMaven(jdk: 'jdk8', maven: 'maven3') {
					sh "mvn -f ./test4Jenkins/pom.xml compile"
				}
             }
        }
    }
}